# server-cdc
Применение шаблона `CDC` для распространения бизнес параметров системы

## Необходимо

Необходимо реализовать сервис по распространению и управлению бизнес параметрами системы. Сервис должен обеспечивать
работу при больших нагрузках, а при изменении параметра не должен приводить к перезагрузкам контекста `Spring`.

### Ограничения

1. Интерфейс взаимодействия с сервисом (получение параметров и их изменение) должен быть основан на `GRPC`;
2. Бизнес параметры могут располагаться в разных таблицах (схемах) СУБД, при этом должны иметь поля которые 
	можно ассоциировать со строковым представлением ключ/значение, остальные строки/параметры могут быть представлены
	как атрибуты. Бизнес параметры в разных таблицах представляют собой разные множества, при этом каждое множество
	представляет собой именованный набор (`namespace`). Пример, обобщенной записи.
	```java
	record Entity(String key, String value, Map<String, Object> attributes) {}
	record Namesapce(String name, Map<String, Entity> values) {}
	```;
3. Добавление нового набора бизнес параметров не должно приводить к изменению в коде;
4. Сервис должен хранить отображение бизнес параметров в памяти (кеш), если это возможно, и в случае обрыва соединения
	с СУБД предоставлять только механизм чтения данных, но не их изменение;
5. Клиентская часть сервиса (на стороне потребителя) должна обеспечивать работу даже при потери соединения с сервисом и 
	невозможности получить актуальные параметры (использовать старые значения) и при появлении соединения актуализировать
	их. 
6. При изменении данных через интерфейс (п. 1), сервис меняет значение из набора (и соответствующую запись в СУБД) и 
	после применения изменений оповещает (каким либо образом) подписанта об изменении записи;

[Описание](properties-server/doc/README.md)

### Варианты реализации

Сервис должен иметь базовый механизм по работе с бизнес параметрами и реализован как отдельный `maven` модуль. В качестве фреймворка
нужно использовать `String Boot` в минимальном представлении. Варианты реализации, в свою очередь, должны быть представлены также как 
`maven` модули и подключаться в сборку посредством `maven` профилей, при этом взаимодействие с ними должно происходить как. `Spring` 
компоненты (`DI`).

#### `Redis`

В качестве промежуточного хранилища параметров и механизма оповещения потребителя об изменении параметров следует использовать `Redis`. В
качестве одного из способов оповещения можно использовать `streaming`.

#### `Etcd`

В качестве промежуточного хранилища параметров и механизма оповещения потребителя об изменении параметров следует использовать `Etcd`. 
В качестве одного из способов оповещения можно использовать `watch`.

#### `WebSocket`

В данной реализации нет промежуточного хранилища. Обеспечивается постоянная связь с потребителем и производится его оповещение при 
изменении параметров по протоколу `WebSocket`.

#### `LongPolling`

В данной реализации нет промежуточного хранилища. Обеспечивается постоянная связь с потребителем и производится его оповещение при 
изменении параметров в самописном формате. Механизм работы описывается отдельно, единственное ограничение - он должен быть инкрементальным.

[Описание](providers/longpolling/doc/README.md)
